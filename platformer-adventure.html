<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Platformer Adventure - SeedFrames Engine</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            font-family: 'Arial', sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
        }
        #game-container {
            border: 3px solid #333;
            border-radius: 10px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            background: #000;
        }
        h1 {
            color: white;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            margin-bottom: 20px;
        }
        .controls {
            color: white;
            background: rgba(0,0,0,0.7);
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
            text-align: center;
        }
    </style>
</head>
<body>
    <h1>üèÉ‚Äç‚ôÇÔ∏è Platformer Adventure</h1>
    <div id="game-container"></div>
    <div class="controls">
        <p><strong>Controls:</strong> WASD or Arrow Keys to move, Space to jump</p>
        <p><strong>Goal:</strong> Collect coins and avoid enemies!</p>
    </div>

    <script src="src/seedframes.js"></script>
    <script>
        // Wait for engine to load
        function checkEngine() {
            if (typeof GameEngine !== 'undefined' && GameEngine.SeedFrames) {
                initGame();
            } else {
                setTimeout(checkEngine, 100);
            }
        }

        async function initGame() {
            const engine = new GameEngine.SeedFrames({
                width: 800,
                height: 600,
                containerId: 'game-container',
                backgroundColor: '#87CEEB',
                debug: true
            });

            // Register SVG assets
            await engine.assetManagement({
                assets: {
                    player: GameEngine.SVG(`
                        <svg xmlns="http://www.w3.org/2000/svg" width="32" height="48" viewBox="0 0 32 48">
                            <!-- Head -->
                            <circle cx="16" cy="12" r="8" fill="#FFB6C1"/>
                            <!-- Body -->
                            <rect x="12" y="20" width="8" height="16" fill="#4A90E2"/>
                            <!-- Arms -->
                            <rect x="8" y="22" width="4" height="12" fill="#4A90E2"/>
                            <rect x="20" y="22" width="4" height="12" fill="#4A90E2"/>
                            <!-- Legs -->
                            <rect x="12" y="36" width="3" height="12" fill="#2E5C8A"/>
                            <rect x="17" y="36" width="3" height="12" fill="#2E5C8A"/>
                            <!-- Eyes -->
                            <circle cx="14" cy="10" r="1" fill="#000"/>
                            <circle cx="18" cy="10" r="1" fill="#000"/>
                        </svg>
                    `),
                    platform: GameEngine.SVG(`
                        <svg xmlns="http://www.w3.org/2000/svg" width="64" height="16" viewBox="0 0 64 16">
                            <rect width="64" height="16" fill="#8B4513"/>
                            <rect x="2" y="2" width="60" height="12" fill="#A0522D"/>
                            <rect x="4" y="4" width="56" height="8" fill="#CD853F"/>
                        </svg>
                    `),
                    coin: GameEngine.SVG(`
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16">
                            <circle cx="8" cy="8" r="7" fill="#FFD700" stroke="#FFA500" stroke-width="1"/>
                            <text x="8" y="11" text-anchor="middle" font-size="8" font-weight="bold" fill="#B8860B">$</text>
                        </svg>
                    `),
                    enemy: GameEngine.SVG(`
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
                            <circle cx="12" cy="12" r="10" fill="#FF4444"/>
                            <circle cx="9" cy="9" r="2" fill="#000"/>
                            <circle cx="15" cy="9" r="2" fill="#000"/>
                            <path d="M 8 15 Q 12 18 16 15" stroke="#000" stroke-width="2" fill="none"/>
                            <path d="M 6 6 L 8 4 M 18 6 L 16 4" stroke="#000" stroke-width="1"/>
                        </svg>
                    `),
                    background: GameEngine.SVG(`
                        <svg xmlns="http://www.w3.org/2000/svg" width="800" height="600" viewBox="0 0 800 600">
                            <defs>
                                <linearGradient id="sky" x1="0%" y1="0%" x2="0%" y2="100%">
                                    <stop offset="0%" style="stop-color:#87CEEB"/>
                                    <stop offset="100%" style="stop-color:#E0F6FF"/>
                                </linearGradient>
                            </defs>
                            <rect width="800" height="600" fill="url(#sky)"/>
                            <!-- Clouds -->
                            <circle cx="100" cy="80" r="20" fill="white" opacity="0.8"/>
                            <circle cx="120" cy="80" r="25" fill="white" opacity="0.8"/>
                            <circle cx="140" cy="80" r="20" fill="white" opacity="0.8"/>
                            <circle cx="300" cy="120" r="15" fill="white" opacity="0.8"/>
                            <circle cx="320" cy="120" r="20" fill="white" opacity="0.8"/>
                            <circle cx="340" cy="120" r="15" fill="white" opacity="0.8"/>
                        </svg>
                    `)
                }
            });

            const scene = new GameEngine.Scene('main');
            engine.sceneManager.add('main', scene);

            // Create player
            const player = scene.createGameObject('Player')
                .at(100, 300)
                .asset('player', 32, 48)
                .withCollider('box', 32, 48, false, 'Player')
                .withPlatformerPlayer({
                    speed: 200,
                    jumpForce: 400,
                    gravity: 800,
                    onJump: () => console.log('Player jumped!'),
                    onLand: () => console.log('Player landed!')
                })
                .build();

            // Create platforms
            const platforms = [
                { x: 0, y: 550, width: 200, height: 50 },
                { x: 250, y: 450, width: 150, height: 50 },
                { x: 450, y: 350, width: 150, height: 50 },
                { x: 650, y: 250, width: 150, height: 50 },
                { x: 100, y: 200, width: 100, height: 50 },
                { x: 300, y: 150, width: 100, height: 50 },
                { x: 500, y: 100, width: 100, height: 50 }
            ];

            platforms.forEach((platform, index) => {
                scene.createGameObject(`Platform_${index}`)
                    .at(platform.x + platform.width/2, platform.y + platform.height/2)
                    .asset('platform', platform.width, platform.height)
                    .withCollider('box', platform.width, platform.height, false, 'Platform')
                    .build();
            });

            // Create coins
            const coinPositions = [
                { x: 125, y: 400 },
                { x: 325, y: 300 },
                { x: 525, y: 200 },
                { x: 725, y: 100 },
                { x: 150, y: 50 }
            ];

            coinPositions.forEach((pos, index) => {
                const coin = scene.createGameObject(`Coin_${index}`)
                    .at(pos.x, pos.y)
                    .asset('coin', 16, 16)
                    .withCollider('circle', 16, 16, true, 'Collectible')
                    .build();

                // Add coin collection logic
                const collider = coin.getComponent(GameEngine.Collider);
                collider.onCollisionEnter = (other) => {
                    if (other.getComponent(GameEngine.PlatformerPlayer)) {
                        coin.destroy();
                        console.log(`Coin collected! Total: ${scene.findGameObjectsByName('Coin').length}`);
                    }
                };
            });

            // Create enemies
            const enemyPositions = [
                { x: 300, y: 400 },
                { x: 600, y: 200 }
            ];

            enemyPositions.forEach((pos, index) => {
                const enemy = scene.createGameObject(`Enemy_${index}`)
                    .at(pos.x, pos.y)
                    .asset('enemy', 24, 24)
                    .withCollider('circle', 24, 24, false, 'Enemy')
                    .build();

                // Simple enemy movement
                let direction = 1;
                const moveSpeed = 50;
                enemy.update = (deltaTime) => {
                    enemy.transform.position.x += direction * moveSpeed * deltaTime;
                    if (enemy.transform.position.x > 750 || enemy.transform.position.x < 50) {
                        direction *= -1;
                    }
                };

                // Enemy collision with player
                const collider = enemy.getComponent(GameEngine.Collider);
                collider.onCollisionEnter = (other) => {
                    if (other.getComponent(GameEngine.PlatformerPlayer)) {
                        console.log('Player hit by enemy!');
                        // Reset player position
                        other.transform.position = new GameEngine.Vector2(100, 300);
                    }
                };
            });

            // Add particle system for effects
            const particleSystem = scene.createGameObject('ParticleSystem')
                .at(0, 0)
                .withComponent(new GameEngine.ParticleEmitter())
                .build();

            const emitter = particleSystem.getComponent(GameEngine.ParticleEmitter);
            emitter.setExplosionConfig();

            // Add UI
            const uiSystem = new GameEngine.UISystem();
            scene.addGameObject(uiSystem);

            const scoreText = new GameEngine.UIText('Score: 0', 20, 20, '#FFFFFF', '20px Arial');
            uiSystem.addElement(scoreText);

            const livesText = new GameEngine.UIText('Lives: 3', 20, 50, '#FFFFFF', '20px Arial');
            uiSystem.addElement(livesText);

            // Game state
            let score = 0;
            let lives = 3;

            // Update UI
            scene.update = (deltaTime) => {
                const remainingCoins = scene.findGameObjectsByName('Coin').length;
                const totalCoins = coinPositions.length;
                score = (totalCoins - remainingCoins) * 100;
                
                scoreText.text = `Score: ${score}`;
                livesText.text = `Lives: ${lives}`;
            };

            // Load the scene
            engine.sceneManager.load('main');
            
            // Start the engine
            engine.start();
        }

        // Start checking for engine
        checkEngine();
    </script>
</body>
</html>